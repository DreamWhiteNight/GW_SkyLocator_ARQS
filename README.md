# CBC-SkyNet II (GW-SkyLocator-ARQS ver.)

This repository contains the major codes for the paper: "Rapid localization of the known gravitational wave events using the deep learning" - Huang et al. (2026).

The major business in this repository is to figure out the sky localization (i.e., Right Ascension (RA) and Declination (Dec)) credible interval of a graviational wave (GW) compact binary coalescence (CBC) event, including the binary black holes (BBH), binary neutron stars (BNS) and the neutron star - black hole binary (NSBH). By the application of the deep learning method, the recognition of the loclization of each event can be avhieved within 1 sec. The modified CBC-SkyNet (GW-SkyLocator-ARQS ver.) was developed from the original [GW-SkyLocator](https://github.com/chayanchatterjee/GW-SkyLocator) ([Chatterjee et al., 2023](https://iopscience.iop.org/article/10.3847/1538-4357/ad08b7)) code while the main system contains 3 major components, including a ResNet-34, fully-connected (dense) network and an autoregressive rational quadratic spline flow (ARQS) flow. Similar to the earlier CBC-SkyNet version as shown in the following fugure, our method requires the signal-to-noise ratio (SNR) time series input to the ResNet-34, the intrinsic parameters input to the dense network, and an auto-regressive quadratic spline ([ARQS](https://arxiv.org/abs/2302.12024)) flow applied to learn mapping between a multivariate Gaussian (base distribution) to the more complex posterior distribution of the sky localization.     
![ARQS](https://github.com/DreamWhiteNight/GW_SkyLocator_ARQS/blob/main/GW-SkyLocator_architecture.png) 

For the complexed SNR time series input to the ResNet-34, we can obtained them through the matached filtering using the optimal GW approximants applied to the GW strain data. A short time SNR time series (0.1-0.2 sec) is enough to gather enough information to generate the reliable result in our method. For the intrinsic parameters input to the dense network, we considered three major parameters (i.e., amplitude ratio and phase lag behaved in different detectors and mergering time epoch) containing the sky localization information. In the updated tests, we included more data points relevant to the amplitude ratio and phase lag around the mergeing epoch in the training process in order to obtain more precise estimation of the final result.       

The ARQS flow envolved from the masked auto-regressive flow ([MAF](https://arxiv.org/abs/1705.07057)) is the key component of the updated CBC-SkyNet. It uses the MADE architecture to learn the transformation parameters that defines the mapping between the two parameter spaces. Similar to the MAF network, the features extracted from real and imaginary parts of the SNR time series, and intrinsic source parameters can be gatherered to map to the conditional probability distributions of the RA and Dec posteriors. Our code was developed via Python using the [TensorFlow 2](https://www.tensorflow.org/?hl=zh-tw) package.
   
# Sample Generation

The training and test set samples used for this work were generated using the repository damonbeveridge/samplegen, which adds additional features to the sample generation code written by Timothy Gebhard and Niki Kilbertus described in the paper Convolutional neural networks: A magic bullet for gravitational-wave detection?
