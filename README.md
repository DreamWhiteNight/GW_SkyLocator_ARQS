# CBC-SkyNet II (GW-SkyLocator-ARQS ver.)

This repository contains the major codes for the paper: "Rapid localization of the known gravitational wave events using the deep learning" - Huang et al. (2026).

The major business in this repository is to figure out the sky localization (i.e., Right Ascension (RA) and Declination (Dec)) credible interval of a graviational wave (GW) compact binary coalescence (CBC) event, including the binary black holes (BBH), binary neutron stars (BNS) and the neutron star - black hole binary (NSBH). By the application of the deep learning method, the recognition of the loclization of each event can be avhieved within 1 sec. The modified CBC-SkyNet (GW-SkyLocator-ARQS ver.) was developed from the original [GW-SkyLocator](https://github.com/chayanchatterjee/GW-SkyLocator) ([Chatterjee et al., 2023](https://iopscience.iop.org/article/10.3847/1538-4357/ad08b7)) code while the main system contains 3 major components, including a ResNet-34, fully-connected (Dense) network and an autoregressive rational quadratic spline flow (ARQS) flow. Similar to the earlier version of the CBC-SkyNet, the user input the   

We introduce GW-SkyLocator, a deep learing model that can estimate Right Ascension (RA) and Declination (Dec) posterior distributions from all types of compact binary coalescences - binary black holes, binary neutron stars and neutron star - black hole binary, in around 1 sec. The main component of GW-SkyLocator is a Normalizing Flow, in partcular, a Masked Autoregressive Flow (MAF), trained on the complex signal-to-noise ratio (SNR) time series data obtained from matched filtering of gravitational wave strain data with optimal Numerical Relativity template waveforms.

Normalizing Flow models learn a mapping between a simple base distribution (like a Gaussian) to a more complex distribution. In our case, we train a MAF to map samples drawn from a multivariate Gaussian (base distribution) to the more complex posterior distribution of the RA and Dec parameters. The MAF uses the MADE architecture to learn the transformation parameters that defines the mapping between the two parameter spaces. Since the RA and Dec posteriors are conditional probability distributions, we condition our MAF network on features extracted from real and imaginary parts of the SNR time series, and intrinsic source parameters (component masses and spins) using a ResNet-34 and fully connected neural networks. The diagram of the network architecture is shown below: 
